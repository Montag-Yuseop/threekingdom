# Infra
주소: http://3.39.189.248:8080/

젠킨스 : af75157a9c8c40b0ba0230e6dfa369fc

user : admin

pass : 삼국지전략판덱검색기

## Version
- Java: 17
- Docker: Version 25.0.3, build 4debf41
- Jenkins: Version 2.445


# BE
## Version
Java: 17

## Dependency
- Spring Web
- Lombok
- Spring Boot DevTools
- Docker Compose Support
- MySQL Driver
- Spring Configuration Processor
- Validation
- Spring Data JPA

추가기능
- WebSocket
- Spring Security
- OAuth2 Client
- OAuth2 Resource Server

## 기본 application.yml

```yml
spring:
  config:
    import: optional:file:.env[.properties]
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://${DB_HOST}:${DB_PORT}/${DB_NAME}?serverTimezone=Asia/Seoul&useUnicode=true&characterEncoding=utf8
    username: ${DB_USER}
    password: ${DB_PASS}
  jpa:
    hibernate:
      ddl-auto: create
    properties:
      hibernate:
        show_sql: true
        format_sql: true
logging:
  level:
    org.hibernate.SQL: debug
    root: info
server:
  port: 8081
  servlet:
    context-path: /api/v1
```

# DB

## docker-compose.yml

```yml
services:
  mysql:
    image: 'mysql:latest'
    environment:
      MYSQL_DATABASE: threekingdom
      MYSQL_USER: montag
      MYSQL_PASSWORD: montag8504!
      MYSQL_ROOT_PASSWORD: 1234
    ports:
      - '3307:3306'
    container_name: threekingdom
```

# 데이터 모델링

## 기능

1. 유저 이름으로 검색하면 해당 유저의 덱 리스트와 전법을 볼 수 있다
    + 덱은 장수 병종(특별 병종 포함), 3명, 진급, 전법, 전법 레벨, +병서(?), +아이템(?)

2. 시즌을 선택할 수 있다

3. 나중에 내 덱과 승부 결과를 저장할 수 있다(두 명의 유저와 덱을 선택하면 승부 결과를 보여준다)

4. 유저의 뽑기를 저장할 수 있다(누구 뽑았는지, 언제 뽑았는지, 5+1를 위해)

5. 입장 코드를 알아야 사용할 수 있다
    + 프론트 백 어디서 처리할 것인가?(로그인 기능도 아니면 그냥 프론트에서 인터셉터 해버리는 것도 괜찮은 듯)

6. 이리단 백과사전으로 연동?


## 세부 기능

1. 유저 생성
- 해당 유저가 없는 경우 닉네임을 통해 유저를 생성한다

2. 유저 검색
- 시즌과 닉네임을 검색하면 해당 시즌의 해당 닉네임을 가진 유저 리스트가 등장한다
- 유저 옆에 선택 버튼을 만들어서 한 명의 유저를 가져온다(덱 리스트를 가져온다)

3. 해당 유저가 속한 시즌을 생성한다
- 시즌을 선택하세요 -> 저장 형식으로 진행해야 할 듯

4. 덱을 생성한다
- 덱 생성이 좀 문제가 있다
- 프론트에서 영웅을 각각 입력해 저장한다
- 그럼 각각 Hero들이 저장되고, 덱은 자동으로 생성되나?

5. 덱을 수정한다
- 덱을 조회하면 장수 조합이 나온다
- 장수 정보가 변경되었으면, 수정 버튼을 누른다(값 변경 가능하게 프론트가 바뀐다)
- 수정할 값을 입력하고 저장을 누르면 변경된 값이 적용된다(기본으로 값을 보여줘야 할 듯)

6. 덱 삭제
- cascade로 완성

7. 전적 등록
- 나의 덱과 상대 덱을 선택해서 전적을 생성한다
- 전적이 없는 경우 없다고 출력해준다

8. 전적 조회
- 나의 덱과 상대 덱을 선택해서 교전 수 + 승리 수(퍼센티지)를 출력한다

9. 전적 입력
- 나의 덱과 상대 덱을 통해 전적(Battle)을 가져오고 승리 여부를 선택하면 전적+1, 승리 선택시 승리 + 1을 저장(업데이트) 한다

10. 덱이 사라지면 전적도 같이 사라진다

11. 전적을 초기화 하는 기능을 생성한다(혹시 처음부터 다시 입력하고 싶으면)

